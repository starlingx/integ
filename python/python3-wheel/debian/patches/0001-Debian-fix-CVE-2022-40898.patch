From b4bd57a8e5422f2283b052c86402913d90e5f960 Mon Sep 17 00:00:00 2001
From: Peng Zhang <Peng.Zhang2@windriver.com>
Date: Wed, 23 Apr 2025 13:46:25 +0800
Subject: [PATCH] Debian: fix CVE-2022-40898

Fixed potential DoS attack via WHEEL_INFO_RE

Signed-off-by: Alex Gr√∂nholm <alex.gronholm@nextday.fi>

For currently in debian, there is no fix for CVE-2022-40898. So add
source package and backport commit which is:
88f02bc335d5404991e532e7f3b0fc80437bf4e0 in
https://github.com/pypa/wheel/commit/.

It will fix potential DoS attack via the ``WHEEL_INFO_RE`` regular
expression.

(Adapt for context change)
Signed-off-by: Peng Zhang <Peng.Zhang2@windriver.com>
(cherry picked from commit 88f02bc335d5404991e532e7f3b0fc80437bf4e0)
---
 src/wheel/wheelfile.py | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/src/wheel/wheelfile.py b/src/wheel/wheelfile.py
index acc5dab..bc4e8d7 100644
--- a/src/wheel/wheelfile.py
+++ b/src/wheel/wheelfile.py
@@ -16,8 +16,8 @@ from wheel.util import urlsafe_b64decode, as_unicode, native, urlsafe_b64encode,
 # Non-greedy matching of an optional build number may be too clever (more
 # invalid wheel filenames will match). Separate regex for .dist-info?
 WHEEL_INFO_RE = re.compile(
-    r"""^(?P<namever>(?P<name>.+?)-(?P<ver>.+?))(-(?P<build>\d[^-]*))?
-     -(?P<pyver>.+?)-(?P<abi>.+?)-(?P<plat>.+?)\.whl$""",
+    r"""^(?P<namever>(?P<name>[^-]+?)-(?P<ver>[^-]+?))(-(?P<build>\d[^-]*))?
+     -(?P<pyver>[^-]+?)-(?P<abi>[^-]+?)-(?P<plat>[^.]+?)\.whl$""",
     re.VERBOSE)
 
 
-- 
2.34.1

