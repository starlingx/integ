From 6c385528bb28e61b9e83b05315d8b076e0db8a87 Mon Sep 17 00:00:00 2001
From: Andre Kantek <andrefernandozanella.kantek@windriver.com>
Date: Tue, 9 Sep 2025 09:19:54 -0300
Subject: [PATCH] Only generate lack of address warning if method isn't manual

The script check-duplicate-ip is generating warning message about
lack of address config in the interface even if the method is manual.
The manual method does not provide address to be tested.

This change adds this logic to decide if generates a warning message.


Signed-off-by: Andre Kantek <andrefernandozanella.kantek@windriver.com>
---
 if-up-scripts/check-duplicate-ip  | 6 ++++--
 if-up-scripts/check-network-cable | 2 +-
 2 files changed, 5 insertions(+), 3 deletions(-)

diff --git a/if-up-scripts/check-duplicate-ip b/if-up-scripts/check-duplicate-ip
index c9641fe..a3747ba 100755
--- a/if-up-scripts/check-duplicate-ip
+++ b/if-up-scripts/check-duplicate-ip
@@ -111,7 +111,7 @@ find_ip() {
 }
 
 if [ -z "$IFACE" ] ; then
-    echo "ERROR: Do not know what interface to check. IFACE environment variable is not defined!" >&2
+    $OUT_ERR "Do not know what interface to check. IFACE environment variable is not defined!"
     exit 0
 fi
 
@@ -128,7 +128,9 @@ esac
 [ -z "$IF_ADDRESS" ] && find_ip
 # Still no IP? Bail out
 if [ -z "$IF_ADDRESS" ] ; then
-    $OUT_WARN "Cannot check for duplicate IPv4 address in the network as the script could not find the IPv4 address of $IFACE. You can disable this test by setting DO_ARPING to 'no' in $DEFAULT ."
+    if [[ "$METHOD" != 'manual' ]]; then
+        $OUT_WARN "Cannot check for duplicate IPv4 address in the network as the script could not find the IPv4 address of $IFACE. You can disable this test by setting DO_ARPING to 'no' in $DEFAULT ."
+    fi
     exit 0
 fi
 
diff --git a/if-up-scripts/check-network-cable b/if-up-scripts/check-network-cable
index 6b997e8..ce15e80 100755
--- a/if-up-scripts/check-network-cable
+++ b/if-up-scripts/check-network-cable
@@ -144,7 +144,7 @@ check_ethernet_status() {
 		check_status_sysfs || status=$?
 	fi
 	[ $status -eq 0 ] ||
-		$OUTPUT "WARNING: Initialising interface $IFACE which does" \
+		$OUT_WARN "Initialising interface $IFACE which does" \
 			"not have a link"
 	return $status
 }
-- 
2.34.1

